heart_metadata <- fread("../Heart/metadata.csv")
heart_pd <- create_protdata(heart_data, condition = heart_metadata)
pd_combined <- combine(heart_pd, pd)
pd_combined <- combine(c(heart_pd, pd))
View(tasd)
View(dsfd)
devtools::load_all()
setwd("~/ProtPipe/R")
devtools::load_all()
pd_combined <- combine(c(heart_pd, pd))
View(dsfd)
View(tasd)
devtools::load_all()
pd_combined <- combine(c(heart_pd, pd))
View(pd)
View(pd_combined)
View(pd_combined@data)
View(pd_combined@condition)
View(pd_combined)
View(pd_combined@prot_meta)
devtools::load_all()
pd_combined <- combine(c(heart_pd, pd))
View(dsfd)
View(tasd)
pd_combined <- combine(c(heart_pd, pd))
devtools::load_all()
pd_combined <- combine(c(heart_pd, pd))
View(pd_combined)
View(pd_combined@data)
View(pd_combined@prot_meta)
View(pd_combined@condition)
ProtPipe::plot_PCs(pd_combined, condition = "Tissue")
View(heart_metadata)
View(pd_combined)
View(pd_combined@prot_meta)
neuron_genes <- fread("~/ProtPipe/EXAMPLES/basic_example_data/neuron_gene.csv")
neuron_genes <- fread("~/ProtPipe/EXAMPLES/basic_example_data/neuron_gene.csv")$Genes
neuron_genes <- fread("~/ProtPipe/EXAMPLES/basic_example_data/neuron_gene.csv")
View(neuron_genes)
neuron_genes <- fread("~/ProtPipe/EXAMPLES/basic_example_data/neuron_gene.csv")$Gene
ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes)
devtools::load_all()
neuron_genes <- fread("~/ProtPipe/EXAMPLES/basic_example_data/neuron_gene.csv")$Gene
ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes)
View(pd_combined)
View(pd_combined@prot_meta)
View(pd_combined@data)
devtools::load_all()
ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes)
devtools::load_all()
ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes)
heart_pd <- remove_sample(heart_pd, names(heart_data)[3:length(names(heart_data))])
pd_combined <- combine(c(heart_pd, pd))
ProtPipe::plot_PCs(pd_combined, condition = "Tissue")
neuron_genes <- fread("~/ProtPipe/EXAMPLES/basic_example_data/neuron_gene.csv")$Gene
ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes, title = "Neuron Markers")
names(heart_data)[3:length(names(heart_data))]
heart_pd <- remove_sample(heart_pd, names(heart_pd@data)[3:length(names(heart_pd@data))])
pd_combined <- combine(c(heart_pd, pd))
ProtPipe::plot_PCs(pd_combined, condition = "Tissue")
heart_pd <- create_protdata(heart_data, condition = heart_metadata)
heart_pd <- remove_sample(heart_pd, names(heart_pd@data)[3:length(names(heart_pd@data))])
pd_combined <- combine(c(heart_pd, pd))
View(heart_pd)
View(heart_pd@data)
View(heart_pd@prot_meta)
View(heart_data)
View(metadata)
View(heart_pd)
View(heart_pd@condition)
View(heart_pd)
View(heart_pd@data)
View(heart_pd@condition)
View(heart_metadata)
View(heart_metadata)
## Combine with other data
heart_data <- fread("../Heart/report.pg_matrix.tsv")
heart_metadata <- fread("../Heart/metadata.csv")
setwd("~/OneDrive - National Institutes of Health/projects/SLAM/brain_pilot")
## Combine with other data
heart_data <- fread("../Heart/report.pg_matrix.tsv")
heart_metadata <- fread("../Heart/metadata.csv")
heart_pd <- create_protdata(heart_data, condition = heart_metadata)
View(heart_pd)
View(heart_pd@condition)
t<- rownames(heart_pd@condition)
setwd("~/ProtPipe/R")
devtools::load_all()
heart_pd <- create_protdata(heart_data, condition = heart_metadata)
t<- rownames(heart_pd@condition)
View(d1)
View(d2)
View(d1)
View(d2)
devtools::load_all()
heart_pd <- create_protdata(heart_data, condition = heart_metadata)
t<- rownames(heart_pd@condition)
heart_pd <- remove_sample(heart_pd, names(heart_pd@data)[3:length(names(heart_pd@data))])
pd_combined <- combine(c(heart_pd, pd))
ProtPipe::plot_PCs(pd_combined, condition = "Tissue")
neuron_genes <- fread("~/ProtPipe/EXAMPLES/basic_example_data/neuron_gene.csv")$Gene
ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes, title = "Neuron Markers")
liver_data <- fread("../Liver/report.pg_matrix.tsv")
setwd("~/OneDrive - National Institutes of Health/projects/SLAM/brain_pilot")
liver_data <- fread("../Liver/report.pg_matrix.tsv")
liver_metadata <- fread("../Liver/metadata.csv")
liver_pd <- create_protdata(liver_data, condition = liver_metadata)
liver_pd <- remove_sample(liver_pd, names(liver_pd@data)[3:length(names(liver_pd@data))])
View(liver_pd)
kidney_data <- fread("../Kidney/report.pg_matrix.tsv")
kidney_metadata <- fread("../Kidney/metadata.csv")
kidney_pd <- create_protdata(kidney_data, condition = kidney_metadata)
kidney_pd <- remove_sample(kidney_pd, names(kidney_pd@data)[3:length(names(kidney_pd@data))])
muscle_data <- fread("../Muscle/report.pg_matrix.tsv")
muscle_metadata <- fread("../Muscle/metadata.csv")
muscle_pd <- create_protdata(muscle_data, condition = muscle_metadata)
muscle_pd <- remove_sample(muscle_pd, names(muscle_pd@data)[3:length(names(muscle_pd@data))])
pd_combined <- combine(c(heart_pd, muscle_pd, kidney_pd, liver_pd, pd))
View(liver_pd)
View(liver_pd@condition)
View(kidney_pd)
View(kidney_pd@condition)
View(muscle_pd)
View(muscle_pd@condition)
## Combine with other data
heart_data <- fread("../Heart/report.pg_matrix.tsv")
heart_metadata <- fread("../Heart/metadata.csv")
heart_pd <- create_protdata(heart_data, condition = heart_metadata)
heart_pd <- remove_sample(heart_pd, names(heart_pd@data)[3:length(names(heart_pd@data))])
liver_data <- fread("../Liver/report.pg_matrix.tsv")
liver_metadata <- fread("../Liver/metadata.csv")
liver_pd <- create_protdata(liver_data, condition = liver_metadata)
liver_pd <- remove_sample(liver_pd, names(liver_pd@data)[3:length(names(liver_pd@data))])
kidney_data <- fread("../Kidney/report.pg_matrix.tsv")
kidney_metadata <- fread("../Kidney/metadata.csv")
kidney_pd <- create_protdata(kidney_data, condition = kidney_metadata)
kidney_pd <- remove_sample(kidney_pd, names(kidney_pd@data)[3:length(names(kidney_pd@data))])
muscle_data <- fread("../Muscle/report.pg_matrix.tsv")
muscle_metadata <- fread("../Muscle/metadata.csv")
muscle_pd <- create_protdata(muscle_data, condition = muscle_metadata)
muscle_pd <- remove_sample(muscle_pd, names(muscle_pd@data)[3:length(names(muscle_pd@data))])
pd_combined <- combine(c(heart_pd, muscle_pd, kidney_pd, liver_pd, pd))
ProtPipe::plot_PCs(pd_combined, condition = "Tissue")
neuron_genes <- fread("~/ProtPipe/EXAMPLES/basic_example_data/neuron_gene.csv")$Gene
ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes, title = "Neuron Markers")
devtools::load_all()
setwd("~/ProtPipe/R")
devtools::load_all()
ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes, title = "Neuron Markers")
ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes, title = "Neuron Markers", condition = "Tissue")
devtools::load_all()
ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes, title = "Neuron Markers", condition = "Tissue")
p <- ProtPipe::plot_pg_counts(pd)
ggsave(p)
ggsave("pg_counts_brain.pdf",p)
setwd("~/OneDrive - National Institutes of Health/projects/SLAM/brain_pilot")
ggsave("pg_counts_brain.pdf",p)
p<-ProtPipe::plot_CVs(pd, condition = "region")
ggsave("figures/cv_brain.pdf",p)
p<-ProtPipe::plot_PCs(pd, condition = "region")
ggsave("figures/pca_brain.pdf",p)
ggsave("figures/cv_brain.pdf",p, width = 8, height = 8)
p<-ProtPipe::plot_CVs(pd, condition = "region")
ggsave("figures/cv_brain.pdf",p, width = 8, height = 8)
p<-ProtPipe::plot_PCs(pd, condition = "region")
ggsave("figures/pca_brain.pdf",p, width = 8, height = 8)
p<-ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes, title = "Neuron Markers", condition = "Tissue")
ggsave("figures/pca_brain.pdf",p, width = 12, height = 8)
p<-ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes, title = "Neuron Markers", condition = "Tissue")
ggsave("figures/neuron_markers_brain.pdf",p, width = 12, height = 8)
p<-ProtPipe::plot_PCs(pd, condition = "region")
ggsave("figures/pca_brain.pdf",p, width = 8, height = 8)
View(pd)
View(pd@condition)
p <- ProtPipe::plot_pg_counts(pd, condition = "region")
ggsave("pg_counts_brain_region.pdf",p)
setwd("~/OneDrive - National Institutes of Health/projects/SLAM/brain_pilot")
data <- fread("brain_pg.csv") %>% as.data.frame()
metadata <- fread("brain_conditions.csv")%>% as.data.frame()
pd <- ProtPipe::create_protdata(data, condition = metadata)
p <- ProtPipe::plot_pg_counts(pd)
ggsave("pg_counts_brain.pdf",p)
p <- ProtPipe::plot_pg_counts(pd, condition = "region")
ggsave("pg_counts_brain_region.pdf",p)
ProtPipe::plot_PCs(kidney_pd)
ProtPipe::plot_PCs(kidney_pd,condition = "Age")
View(kidney_pd)
kidney_data <- fread("../Kidney/report.pg_matrix.tsv")
kidney_metadata <- fread("../Kidney/metadata.csv")
kidney_pd <- create_protdata(kidney_data, condition = kidney_metadata)
ProtPipe::plot_PCs(kidney_pd,condition = "Age")
ProtPipe::plot_PCs(kidney_pd,condition = "age")
kidney_pd <- create_protdata(kidney_data, condition = kidney_metadata) %>% remove_outliers()
ProtPipe::plot_PCs(kidney_pd,condition = "age")
ProtPipe::plot_PCs(kidney_pd,condition = "batch")
View(kidney_pd@condition)
ProtPipe::plot_PCs(kidney_pd,condition = "MS.Batch")
liver_data <- fread("../Liver/report.pg_matrix.tsv")
liver_metadata <- fread("../Liver/metadata.csv")
liver_pd <- create_protdata(liver_data, condition = liver_metadata) %>% remove_outliers()
ProtPipe::plot_PCs(liver_pd,condition = "MS.Batch")
View(liver_pd@condition)
ProtPipe::plot_PCs(liver_pd,condition = "Prepartation batch")
ProtPipe::plot_PCs(liver_pd,condition = "Prepartation Batch")
liver_data <- fread("../Liver/report.pg_matrix.tsv")
liver_metadata <- fread("../Liver/metadata.csv")
liver_pd <- create_protdata(liver_data, condition = liver_metadata) %>% remove_outliers()
ProtPipe::plot_PCs(liver_pd,condition = "Prepartation Batch")
ProtPipe::plot_PCs(liver_pd,condition = "Preparation Batch")
ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
liver_data_corrected <- batch_correct("Preparation batch")
liver_data_corrected <- liver_pd %>% batch_correct("Preparation batch")
liver_pd_corrected <- liver_pd %>% batch_correct("Preparation batch")
ProtPipe::plot_PCs(liver_pd_corrected,condition = "Preparation batch")
ProtPipe::plot_hierarchical_cluster(liver_pd)
liver_pd <- liver_pd %>% remove_sample(c("SLAM_61"))
ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
ProtPipe::plot_hierarchical_cluster(liver_pd)
liver_pd <- liver_pd %>% remove_sample(c("SLAM_61", "SLAM_116"))
ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
ProtPipe::plot_hierarchical_cluster(liver_pd)
liver_pd <- liver_pd %>% remove_sample(c("SLAM_61", "SLAM_116", "SLAM_75"))
ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
liver_pd <- liver_pd %>% remove_sample(c("SLAM_61", "SLAM_116", "SLAM_75", "SLAM_47"))
liver_pd <- liver_pd %>% remove_sample(c("SLAM_61", "SLAM_116", "SLAM_75", "SLAM_47"))
ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
ProtPipe::plot_hierarchical_cluster(liver_pd)
liver_pd <- liver_pd %>% remove_sample(c("SLAM_61", "SLAM_116", "SLAM_75", "SLAM_47", "SLAM_68", "SLAM_65"))
ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
ProtPipe::plot_hierarchical_cluster(liver_pd)
liver_pd <- liver_pd %>% remove_sample(c("SLAM_61", "SLAM_116", "SLAM_75", "SLAM_47", "SLAM_68", "SLAM_65", "SLAM_95", "SLAM_117"))
ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
ProtPipe::plot_hierarchical_cluster(liver_pd)
liver_pd <- liver_pd %>% remove_sample(c("SLAM_61", "SLAM_116", "SLAM_75", "SLAM_47", "SLAM_68", "SLAM_65", "SLAM_95", "SLAM_117", "SLAM_113", "SLAM_78", "SLAM_97"))
ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
ProtPipe::plot_hierarchical_cluster(liver_pd)
liver_pd <- liver_pd %>% remove_sample(c("SLAM_61", "SLAM_116", "SLAM_75", "SLAM_47", "SLAM_68", "SLAM_65", "SLAM_95", "SLAM_117", "SLAM_133", "SLAM_78", "SLAM_97"))
ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
liver_pd <- create_protdata(liver_data, condition = liver_metadata) %>% remove_outliers()
ProtPipe::plot_hierarchical_cluster(liver_pd)
liver_pd <- liver_pd %>% remove_sample(c("SLAM_133", "SLAM_78", "SLAM_97"))
ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
ProtPipe::plot_PCs(liver_pd,condition = "age")
liver_pd_corrected <- liver_pd %>% batch_correct("Preparation batch")
ProtPipe::plot_PCs(liver_pd_corrected,condition = "Preparation batch")
ProtPipe::plot_PCs(liver_pd_corrected,condition = "age")
setwd("~/OneDrive - National Institutes of Health/projects/SLAM/brain_pilot/protpipe_labmeeting")
ggsave("pca_b4_batch.png",p)
p <- ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
ggsave("pca_b4_batch.png",p)
ggsave("pca_b4_batch.png",p, width = 8, height = 8)
liver_pd <- liver_pd %>% remove_sample(c("SLAM_133", "SLAM_78", "SLAM_97"))
p <- ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
ProtPipe::plot_hierarchical_cluster(liver_pd)
liver_pd <- create_protdata(liver_data, condition = liver_metadata) %>% remove_outliers()
ProtPipe::plot_hierarchical_cluster(liver_pd)
liver_pd <- liver_pd %>% remove_sample(c("SLAM_133", "SLAM_78", "SLAM_97"))
p <- ProtPipe::plot_PCs(liver_pd,condition = "Preparation batch")
ggsave("pca_b4_batch.png",p, width = 8, height = 8)
p <- ProtPipe::plot_PCs(liver_pd,condition = "age")
ggsave("pca_b4_age.png",p, width = 8, height = 8)
liver_pd_corrected <- liver_pd %>% batch_correct("Preparation batch")
p <- ProtPipe::plot_PCs(liver_pd_corrected,condition = "Preparation batch")
ggsave("pca_after_batch.png",p, width = 8, height = 8)
p <- ProtPipe::plot_PCs(liver_pd_corrected,condition = "age")
ggsave("pca_after_age.png",p, width = 8, height = 8)
setwd("~/OneDrive - National Institutes of Health/projects/SLAM/brain_pilot")
p <- ProtPipe::plot_pg_counts(pd, condition = "region")
ggsave("figures/pg_counts_brain_region.pdf",p)
ggsave("figures/pg_counts_brain_region.png",p)
ggsave("figures/pg_counts_brain_region.png",p, width = 8, height = 6)
runApp('~/ProtPipe/ProtPipe_shiny')
p<-ProtPipe::plot_PCs(pd)
ProtPipe::plot_PCs(pd)
View(pd)
View(pd@condition)
metadata <- fread("brain_conditions.csv")%>% as.data.frame()
metadata$sample1 <- metadata$sample
pd <- ProtPipe::create_protdata(data, condition = metadata)
ProtPipe::plot_PCs(pd, condition = "sample1")
library(ProtPipe)
library(data.table)
setwd("~/OneDrive - National Institutes of Health/projects/SLAM/brain_pilot")
data <- fread("brain_pg.csv")
metadata <- fread("brain_conditions.csv")
pd <- ProtPipe::create_protdata(data, condition = metadata)
p <- ProtPipe::plot_pg_counts(pd)
p
# plot some QC plots
ProtPipe::plot_pg_counts(pd)
ProtPipe::plot_pg_counts(pd, condition = "region")
ProtPipe::plot_CVs(pd, condition = "region")
ProtPipe::plot_PCs(pd, condition = "region")
ProtPipe::plot_PCs(pd, condition = "subject")
setwd("~/OneDrive - National Institutes of Health/projects/SLAM/brain_pilot")
## load other protdata objects
heart_data <- fread("../Heart/report.pg_matrix.tsv")
heart_metadata <- fread("../Heart/metadata.csv")
heart_pd <- create_protdata(heart_data, condition = heart_metadata)
heart_pd <- remove_sample(heart_pd, names(heart_pd@data)[3:length(names(heart_pd@data))])
liver_data <- fread("../Liver/report.pg_matrix.tsv")
liver_metadata <- fread("../Liver/metadata.csv")
liver_pd <- create_protdata(liver_data, condition = liver_metadata)
liver_pd <- remove_sample(liver_pd, names(liver_pd@data)[3:length(names(liver_pd@data))])
kidney_data <- fread("../Kidney/report.pg_matrix.tsv")
kidney_metadata <- fread("../Kidney/metadata.csv")
kidney_pd <- create_protdata(kidney_data, condition = kidney_metadata)
kidney_pd <- remove_sample(kidney_pd, names(kidney_pd@data)[3:length(names(kidney_pd@data))])
muscle_data <- fread("../Muscle/report.pg_matrix.tsv")
muscle_metadata <- fread("../Muscle/metadata.csv")
muscle_pd <- create_protdata(muscle_data, condition = muscle_metadata)
muscle_pd <- remove_sample(muscle_pd, names(muscle_pd@data)[3:length(names(muscle_pd@data))])
pd_combined <- combine(c(heart_pd, muscle_pd, kidney_pd, liver_pd, pd))
ProtPipe::plot_PCs(pd_combined, condition = "Tissue")
save(heart_pd, liver_pd, kidney_pd, muscle_pd, file = "protpipe_labmeeting/SLAM_datasets.RData")
## load other protdata objects
load("protpipe_labmeeting/SLAM_datasets.RDta")
## load other protdata objects
load("protpipe_labmeeting/SLAM_datasets.RData")
heart_data <- fread("../Heart/report.pg_matrix.tsv")
heart_metadata <- fread("../Heart/metadata.csv")
heart_pd <- create_protdata(heart_data, condition = heart_metadata)
liver_data <- fread("../Liver/report.pg_matrix.tsv")
liver_metadata <- fread("../Liver/metadata.csv")
liver_pd <- create_protdata(liver_data, condition = liver_metadata)
kidney_data <- fread("../Kidney/report.pg_matrix.tsv")
kidney_metadata <- fread("../Kidney/metadata.csv")
kidney_pd <- create_protdata(kidney_data, condition = kidney_metadata)
muscle_data <- fread("../Muscle/report.pg_matrix.tsv")
muscle_metadata <- fread("../Muscle/metadata.csv")
muscle_pd <- create_protdata(muscle_data, condition = muscle_metadata)
save(heart_pd, liver_pd, kidney_pd, muscle_pd, file = "protpipe_labmeeting/SLAM_datasets.RData")
## load other protdata objects
load("protpipe_labmeeting/SLAM_datasets.RData")
s
s
setwd("~/OneDrive - National Institutes of Health/projects/SLAM/brain_pilot")
# create a protdata object
data <- fread("brain_pg.csv")
metadata <- fread("brain_conditions.csv")
pd <- ProtPipe::create_protdata(data, condition = metadata)
# plot some QC plots
ProtPipe::plot_pg_counts(pd)
ProtPipe::plot_pg_counts(pd, condition = "region")
ProtPipe::plot_CVs(pd, condition = "region")
ProtPipe::plot_PCs(pd, condition = "region")
ProtPipe::plot_PCs(pd, condition = "subject")
## load other protdata objects
load("protpipe_labmeeting/SLAM_datasets.RData")
## remove samples from the datasets
heart_pd <- remove_sample(heart_pd, names(heart_pd@data)[3:length(names(heart_pd@data))])
liver_pd <- remove_sample(liver_pd, names(liver_pd@data)[3:length(names(liver_pd@data))])
kidney_pd <- remove_sample(kidney_pd, names(kidney_pd@data)[3:length(names(kidney_pd@data))])
muscle_pd <- remove_sample(muscle_pd, names(muscle_pd@data)[3:length(names(muscle_pd@data))])
## combine protdata objects
pd_combined <- combine(c(heart_pd, muscle_pd, kidney_pd, liver_pd, pd))
ProtPipe::plot_PCs(pd_combined, condition = "Tissue")
neuron_genes <- fread("~/ProtPipe/EXAMPLES/basic_example_data/neuron_gene.csv")$Gene
ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes, title = "Neuron Markers", condition = "Tissue")
# perform differential expression analysis
log2_pd <-ProtPipe::log2_transform(pd)
DE <- ProtPipe::do_limma_by_condition(log2_pd, condition = "region", control_group = "cortex", treatment_group = "hippocampus")
ProtPipe::plot_volcano(DE, label_col = "Genes")
runApp('~/ProtPipe/ProtPipe_shiny')
library(ProtPipe)
library(data.table)
setwd("~/OneDrive - National Institutes of Health/projects/SLAM/brain_pilot")
# create a protdata object
data <- fread("brain_pg.csv")
metadata <- fread("brain_conditions.csv")
View(data)
View(metadata)
pd <- ProtPipe::create_protdata(data, condition = metadata)
# plot some QC plots
ProtPipe::plot_pg_counts(pd)
ProtPipe::plot_pg_counts(pd, condition = "region")
ProtPipe::plot_CVs(pd, condition = "region")
ProtPipe::plot_PCs(pd, condition = "region")
ProtPipe::plot_PCs(pd, condition = "subject")
# perform differential expression analysis
log2_pd <-ProtPipe::log2_transform(pd)
DE <- ProtPipe::do_limma_by_condition(log2_pd, condition = "region", control_group = "cortex", treatment_group = "hippocampus")
ProtPipe::plot_volcano(DE, label_col = "Genes")
## load other protdata objects
load("protpipe_labmeeting/SLAM_datasets.RData")
## remove samples from the datasets
heart_pd <- remove_sample(heart_pd, names(heart_pd@data)[3:length(names(heart_pd@data))])
liver_pd <- remove_sample(liver_pd, names(liver_pd@data)[3:length(names(liver_pd@data))])
kidney_pd <- remove_sample(kidney_pd, names(kidney_pd@data)[3:length(names(kidney_pd@data))])
muscle_pd <- remove_sample(muscle_pd, names(muscle_pd@data)[3:length(names(muscle_pd@data))])
## combine protdata objects
pd_combined <- combine(c(heart_pd, muscle_pd, kidney_pd, liver_pd, pd))
## plot PCA
ProtPipe::plot_PCs(pd_combined, condition = "Tissue")
## plot heatmap
neuron_genes <- fread("~/ProtPipe/EXAMPLES/basic_example_data/neuron_gene.csv")$Gene
ProtPipe::plot_proteomics_heatmap(pd_combined, protmeta_col = "Genes", genes = neuron_genes, title = "Neuron Markers", condition = "Tissue")
runApp('~/ProtPipe/ProtPipe_shiny')
View(pd)
View(pd@condition)
View(pd@prot_meta)
View(pd@data)
View(pd_combined)
View(pd_combined@data)
View(pd_combined@prot_meta)
PD <- pd_combined
protmeta_col <- "Genes"
genes <- neuron_genes
# Check input class
if (!inherits(PD, "ProtData")) {
stop("Error: 'PD' must be of class ProtData")
}
#Extract data
intensities <- PD@data
prot_meta <- PD@prot_meta
condition_file <- PD@condition
if(is.null(protmeta_col)){
protmeta_col <- names(prot_meta)[1]
}
if(is.null(title)){
title <- "Proteomics Heatmap"
}
# Check if protmeta_col exists
if (!protmeta_col %in% colnames(prot_meta)) {
stop(paste("Column", protmeta_col, "not found in PD@prot_meta"))
}
# Optionally subset by genes
if (!is.null(genes)) {
match_genes <- tolower(prot_meta[[protmeta_col]]) %in% tolower(genes)
intensities <- intensities[match_genes, , drop = FALSE]
prot_meta <- prot_meta[match_genes, , drop = FALSE]
}
which(match_genes)
View(prot_meta)
setwd("~/ProtPipe/ProtPipe_shiny")
rsconnect::writeManifest()
devtools::install_github("NIH-CARD/ProtPipe@feature/R_package_clean")
devtools::install_github("NIH-CARD/ProtPipe@feature/R_package_clean", force = TRUE)
rsconnect::writeManifest()
rsconnect::writeManifest()
setwd("~/ProtPipe/ProtPipe_shiny")
library(profvis)
profvis(runApp("app.R"))
profvis(runApp("app.R"))
shiny::runApp('ProtPipe_shiny')
devtools::load_all()
devtools::load_all()
devtools::load_all()
devtools::load_all()
df <- readRDS("EXAMPLES/VIRUS/virus_data.rds")
meta <- readRDS("EXAMPLES/VIRUS/virus_metadata.rds")
dat_pro <- create_protdata(df, meta)
dat_pro <- ProtPipe::create_protdata(df, condition = meta)
ProtPipe::plot_CVs(dat_pro, "virus")
View(dat_pro)
View(dat_pro@condition)
ProtPipe::plot_CVs(dat_pro, "viral.exposure")
ProtPipe::plot_CVs_optim(dat_pro, "viral.exposure")
devtools::load_all()
devtools::document()
ProtPipe::plot_CVs_optim(dat_pro, "viral.exposure")
devtools::document()
devtools::load_all()
ProtPipe::plot_CVs_optim(dat_pro, "viral.exposure")
roxygen2::roxygenise(clean = TRUE)
roxygen2::roxygenise(clean = TRUE)
unlink("NAMESPACE")
unlink("man", recursive = TRUE)
roxygen2::roxygenise(clean = TRUE)
roxygen2::roxygenise(clean = TRUE, load_code = "source")
install.packages("roxygen2")
install.packages("devtools")
roxygen2::roxygenise(clean = TRUE, load_code = "source")
install.packages(roxygen_devtest)
devtools::document()
setwd("~/ProtPipe/R")
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
getwd()
roxygen2::roxygenise()
setwd("~/ProtPipe")
roxygen2::roxygenise()
roxygen2::roxygenise()
devtools::document()
devtools::document()
mem.maxVSize()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise(clean = TRUE)
roxygenize()
document()
devtools::document()
devtools::document()
roxygen2::roxygenize()
roxygen2::roxygenise()
roxygen2::roxygenise()
library(roxygen2)
roxygenize()
library(roxygen2)
roxygenize()
roxygen2::roxygenise()
